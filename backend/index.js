const { ApolloServer, gql } = require("apollo-server");

// ã‚¹ã‚­ãƒ¼ãƒã¨ã¯ã€ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã‚¯ã‚¨ãƒªã®ã€Œå½¢ã€ã‚’å®šç¾©ã™ã‚‹å‹å®šç¾©ã®é›†åˆä½“ï¼ˆã—ãŸãŒã£ã¦ã€ŒtypeDefsã€ï¼‰ã§ã‚ã‚‹ã€‚
const typeDefs = gql`
  # GraphQLã®æ–‡å­—åˆ—ã®ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆã“ã®ã‚ˆã†ãªã‚‚ã®ï¼‰ã¯ã€ãƒãƒƒã‚·ãƒ¥ï¼ˆ#ï¼‰è¨˜å·ã§å§‹ã¾ã‚Šã¾ã™ã€‚

  # ã“ã® "Book "å‹ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®ã™ã¹ã¦ã®æœ¬ã«å¯¾ã—ã¦ã‚¯ã‚¨ãƒªå¯èƒ½ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
  type Book {
    title: String
    author: String
  }

  # "Query "å‹ã¯ç‰¹æ®Šã§ã€åˆ©ç”¨å¯èƒ½ãªã™ã¹ã¦ã®ã‚¯ã‚¨ãƒªã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚
  # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå®Ÿè¡Œå¯èƒ½ã§ã€ãã‚Œãã‚Œã®æˆ»ã‚Šå€¤ã®å‹ã‚‚ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®å ´åˆ
  # ã“ã®å ´åˆã€"books "ã‚¯ã‚¨ãƒªã¯0å€‹ä»¥ä¸Šã®Bookï¼ˆä¸Šã§å®šç¾©ï¼‰ã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
  type Query {
    books: [Book]
  }
`;

// ãƒ‡ãƒ¼ã‚¿æœ¬ä½“
const books = [
  {
    title: "The Awakening",
    author: "ç”°ä¸­ å¤ªéƒ",
  },
  {
    title: "City of Glass",
    author: "Paul Auster",
  },
];

// ãƒªã‚¾ãƒ«ãƒã¯ã€ãã®ä¸­ã§å®šç¾©ã•ã‚ŒãŸå‹ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æŠ€è¡“ã‚’å®šç¾©ã™ã‚‹ã€‚ã‚¹ã‚­ãƒ¼ãƒã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
// ã“ã®ãƒªã‚¾ãƒ«ãƒã¯ã€ä¸Šã® "books" é…åˆ—ã‹ã‚‰æ›¸ç±ã‚’å–å¾—ã—ã¾ã™ã€‚
const resolvers = {
  Query: {
    books: () => books,
  },
};

// ApolloServerã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€2ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¿…è¦ã¨ã—ã¾ã™
// ãƒ»ã‚¹ã‚­ãƒ¼ãƒ ã®å®šç¾©ã¨ã€ãƒªã‚¾ãƒ«ãƒã®ã‚»ãƒƒãƒˆã§ã™ã€‚
const server = new ApolloServer({ typeDefs, resolvers });

// listenãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚
server.listen().then(({ url }) => {
  console.log(`ğŸš€  Server ready at ${url}`);
});
